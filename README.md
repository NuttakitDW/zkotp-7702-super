# zkOTPâ€‘7702â€‘Super

> **Allâ€‘inâ€‘one monorepo for a zeroâ€‘knowledge OTP smartâ€‘account guard, powered by EIPâ€‘7702.**
> Clone once, spin up contracts, circuit, and frontâ€‘end in minutes.

---

## ğŸ—‚Â Repository layout (submodules)

| Path                   | Subâ€‘repository      | Purpose                                                                                          |
| ---------------------- | ------------------- | ------------------------------------------------------------------------------------------------ |
| `contracts/`           | **zkotp-contracts** | Solidity sources (`zkOtpGuard.sol`, autogenerated `Verifier.sol`), Foundry tests, deploy scripts |
| `circuit/`             | **zkotp-circuit**   | RustÂ guest (RISCâ€‘V), `cargo risczero` build scripts, proving key artefacts                       |
| `apps/frontend/`       | **zkotp-frontend**  | Next.js UI: 7702 upgrade wizard, OTP modal, WASM proof wrapper                                   |
| `apps/api/` (opt.)     | **zkotp-api**       | ElysiaJS service for gas refunds & pointerâ€‘change alerts                                         |
| `packages/sdk/` (opt.) | **zkotp-sdk**       | NPM helper `sendOtpTx()` + TS types for proof & guard ABI                                        |

---

## âš¡Â QuickÂ start

```bash
# clone everything, submodules included
$ git clone --recursive https://github.com/yourOrg/zkotp-7702-super.git
$ cd zkotp-7702-super

# install workspace deps & autoâ€‘build circuit WASM
$ pnpm i

# run the frontâ€‘end on http://localhost:3000
$ pnpm dev

# run Foundry tests for contracts
$ forge test -C contracts
```

> **Note**â€‰: if you forget `--recursive`, run `git submodule update --init --recursive` after cloning.

---

## ğŸ—Â Development scripts

| Command                                                       | What it does                                      |
| ------------------------------------------------------------- | ------------------------------------------------- |
| `cargo risczero build`                                        | Compile OTP guest to RISCâ€‘V ELF & WASM            |
| `cargo risczero prove --input time.json --private secret.bin` | Generate a STARK receipt                          |
| `cargo risczero export-solidity`                              | Autogenerate `Verifier.sol` into `contracts/src/` |
| `forge script script/Deploy.s.sol --broadcast --rpc-url=$RPC` | Deploy guard + verifier to Sepolia                |
| `pnpm dev`                                                    | Start Next.js frontâ€‘end                           |
| `pnpm lint`                                                   | Lint all TS/JS workspaces                         |

---

## ğŸ› Â Toolâ€‘chain versions

```text
RustÂ Â Â Â Â Â Â :Â stableÂ 1.79+
RiscÂ ZeroÂ  :Â 0.19+
Node / pnpm:Â v20Â /Â pnpmÂ 9+
FoundryÂ Â Â Â :Â forgeÂ 0.2+
SolcÂ Â Â Â Â Â Â :Â 0.8.24
MetaMaskÂ Â Â :Â â‰¥Â 12.17Â (7702 enabled)
```

---

## ğŸš€Â Deployment guide (Sepolia)

1. `forge create ...` â€“ deploy `Verifier.sol`
2. `forge create ...` â€“ deploy `zkOtpGuard.sol` (pass verifier address)
3. Record the guard address in `.env` of `apps/frontend`.
4. Run the frontâ€‘end and execute the **â€œSecure with OTPâ€** wizard.

---

## ğŸ“œÂ License

All code is released under the MIT License unless stated otherwise.Â See individual submodules for their specific SPDX headers.

---

## ğŸ“‹Â TODO roadmap

### MVP (weekÂ 1)

* [ ] **Circuit**Â â€“ finalize Rust guest; export verifier contract.
* [ ] **Contracts**Â â€“ implement `execute(Call[] calldata, bytes receipt)` with proof verification & nonce checks.
* [ ] **Frontâ€‘end**Â â€“ upgrade wizard (typeâ€‘4 Setâ€‘Code tx) & OTP modal with WASM proof.
* [ ] **Deploy**Â â€“ Sepolia deployment script + sample env.

---

Happy hacking! Feel free to open issues or PRs in their respective subâ€‘repos.
